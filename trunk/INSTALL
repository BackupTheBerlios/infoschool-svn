  Infoschool

Installationsanleitung von Infoschool

####################################################
#              Vorsicht!                           #
# Diese Installationsanleitung ist nicht mehr      #
# gültig. Sie bezieht sich auf eine veraltete      #
# Version. Die Datenbank muss manuell eingerichtet #
# werden. Die ersten Daten muss man selbst         #
# eintragen.                                       #
# Vielleicht macht diese Anleitung trotzdem das    #
# System etwas verständlicher.                     #
####################################################


Vorraussetzungen zum Betrieb von Infoschool (Empfehlungen und Referenzen in Klammern):
 - laufendes Betriebssystem (Linux)
 - Webserver mit PHP-Unterstuetzung (Apache, http://www.apache.org/)
 - PHP4 oder neuer mit MySQL-Erweiterung (http://www.php.net)
 - MySQL (http://www.mysql.com) 

Sehr hilfreich:
 - Ein Programm zum zeitgesteuerten Aufruf von Skripten (Cron)

Vorraussetungen bestimmter Module
 - Mailserver (alle Mailfunktionen)
 - Stundenplaneditor 0.163 von W. Buchholz (Generierung von Vertretungsplaenen)
 - ein Telnetclient zum automatischen Ausfuehren von PHP-Skripten (Vertretungsplan zuschicken lassen)


Installation und Konfiguration:

Nun sollte das komplette Infoschoolprojekt im gleichen Ordner wie diese Datei liegen. Das Verzeichnis htdocs muss ueber den Webserver freigegeben sein.

Folgende Dateien muessen ueberprueft und eventuell geaendert werden:
 http_vertretungsplan_mail.telnet
 mysql_infoschool.php
 install/crontab
 install/db-base-data.dmp
 install/db-no-data.dmp
 htdocs/benutzer/var.php
 htdocs/benutzer/admin/var.php
 htdocs/vertretungsplan/import.php
 htdocs/vertretungsplan/mail.php

In diesen Dateien werden folgende Informationen gebraucht (Beispiele in Klammern):
 MySQL-Servername (localhost)
 MySQL-Benutzername (infoschool)
 MySQL-Passwort (secret)
 MySQL-Datenbank (infoschool)
 Passwort fuer den Benutzeradmin (secret)
 Passwort zum Mail des Vertretungsplanes (secret)
 Verschluesselte Versionen mancher Passwoerter (secret verschluesselt: IN568o5K6dwug)


Fangen wir mit der MySQL-Datenbank an. Infoschool braucht einen Account mit Zugriff auf eine Datenbank. Die Informationen muessen in die Datei mysql_infoschool.php eingetragen werden:
 <?
  $mysql_server = 'localhost';
  $mysql_user = 'infoschool';
  $mysql_passwd = 'secret';
  $mysql_db = 'infoschool';
 ?>

Diese Informationen werden auch noch in der Datei install/crontab gebraucht:
 0       0       *       *       *       mysql -u infoschool --password=secret infoschool < clean.mysql
 0       18      *       *       *       telnet -r localhost 80 < http_vertretungsplan_mail.telnet > /dev/null
Hier muessen eventuell die Pfade zu den Dateien korrigiert werden.


Das Passwort fuer den Benutzeradmin muss an verschiedenen Stellen eingetragen werden.
In der Datei htdocs/benutzer/var.php wird es an der markierten Stelle im Klartext eingetragen.
In der Datei htdocs/benutzer/admin/var.php wird es an der markierten Stelle verschluesselt eingetragen.

Das Passwort zum Mailen des Vertretungsplanes wird auch an zwei Stellen eingetragen.
In der Datei htdocs/vertretungsplan/import.php wird es an der markierten Stelle im Klartext eingetragen.
In der Datei htdocs/vertretungsplan/mail.php wird es an der markierten Stelle verschluesselt eingetragen.
Dieses Passwort muss im Klartext auch noch in die Datei http_vertretungsplan_mail.telnet eingetragen werden:
 GET /vertretungsplan/mail.php?passwd=secret HTTP/1.1
 Host: localhost

 ~.

Mir ist klar, dass diese Passwortloesungen sehr sehr schlecht sind. Sie werden bei einer Ueberarbeitung der Benutzerrechte in Infoschool auch wegfallen, aber erstmal muss damit solange vorlieb genommen werden. Hilfe ist immer willkommen.


Nun muessen manche dieser Daten noch Verwendung finden.

Die Dateien install/db-no-data.dmp und install/db-base-data.dmp muessen in dieser Reihenfolge in die MySQL-Datenbank importiert werden:
 mysql -u infoschool -p infoschool < install/db-no-data.dmp
 mysql -u infoschool -p infoschool < install/db-base-data.dmp

Die Datei install/crontab enthaelt Informationen fuer einen zeitgesteuerten Aufruf von Skripten. Sie kann einfach per crontab eingelesen werden:
 crontab install/crontab
Wenn crontab nicht zur Verfuegung steht, muessen die Skripte, die in dieser Datei stehen, irgendwie anders zeitlich gesteuert gestartet werden. Unter Windows zum Beispiel mit dem Taskmanager.


Damit ist die Installation eigentlich abgeschlossen.
Auf http://localhost/benutzer/admin/?passwd=geheim (oder wo auch immer die Infoschool-Dateien liegen) kann man den ersten Benutzer anlegen sowie zur Adminliste hinzufuegen. Alle weiteren Infoschoolbenutzer sollten das Anmeldeformular (http://localhost/benutzer/neu_antrag.php) benutzen. Sie koennen von allen Personen auf der Adminliste freigeschaltet werden.

Zur Aktualisierung des Vertretungsplanes muss zur Zeit noch in den Dateien htdocs/vertretungsplan/var.php und htdocs/vertretungsplan/import.php die entsprechende Personen-ID freigeschaltet werden.

Einzelne Module werden am besten durch die Auskommentierung im Menue in der Datei htdocs/var.php deaktiviert.
